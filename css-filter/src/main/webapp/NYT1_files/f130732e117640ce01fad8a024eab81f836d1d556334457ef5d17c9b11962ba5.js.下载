window.optimizely.push({type:"load",data:{changes:[{"dependencies": [], "type": "custom_code", "id": "33C4FAE1-10C8-4280-97B2-AC19F1CC9F91", "value": function($){// 040918 INYT dynamic currency and campaign code per meter and region, dynamic offer text per region~208123
//  ---------------------    Internationalize     ---------------------
var utils = window.optimizely.get('utils');

var meterCount = window.NYToptly.meter.pageCount;

var cid = 'desktop';

if ((location.hostname.indexOf('mobile.nytimes.com') > -1) || (window.screen.width < 768)) {
    cid = 'mobile';
}

var getCookie = function (c_name) {
    var cookval = '';
    var i, x, y, ARRcookies = document.cookie.split(";");
    for (i = 0; i < ARRcookies.length; i++) {
        x = ARRcookies[i].substr(0, ARRcookies[i].indexOf("="));
        y = ARRcookies[i].substr(ARRcookies[i].indexOf("=") + 1);
        x = x.replace(/^\s+|\s+$/g, "");
        if (x == c_name) {
            cookval = unescape(y);
        }
    }
    return cookval;
};

var getCurrentLocation = function () {
    var country;
    var testLocation = window.NYToptly.getQueryParameter('location') || getCookie('abTestLocation');

    if (testLocation && testLocation !== '') {
        country = testLocation;
    }
    else {
        country = window.optimizely.get('visitor').location.country;
        var eurozone = ['DE', 'AD', 'AT', 'BE', 'BG', 'HR', 'CY', 'CZ', 'DK', 'EE', 'FI', 'FR', 'GR', 'VA', 'HU', 'IE', 'IT', 'LV', 'LT', 'LU', 'MT', 'MC', 'NL', 'PL', 'PT', 'RO', 'SM', 'SK', 'SI', 'ES', 'SE', 'CH'];
        if (eurozone.indexOf(country) > -1) {
            country = 'EU';
        } else if (country !== 'CA' && country !== 'EU' && country !== 'GB' && country !== 'AU' && country !== 'IN') {
            country = 'US';
        }
    }
    return country;
};

var queryCountry = getCurrentLocation();

// console.log('---------------------------------- ' + queryCountry);

var MKDATA = {
    dock_offer: {
        currencyData: {
            US: {
                offerText: '<strong>Just $1 a week, plus Cooking and Crossword on us.</strong>',
                offerTextMobile: '<strong>Just $1 a week, plus Cooking and Crossword on us.</strong>',
                lp: 'lp8U87R.html',
                cidDesktop1: '7FUK9',
                cidDesktop2: '79UFW',
                cidDesktop3: '79LFJ',
                cidDesktop4: '7X7U8',
                cidDesktop5: '77HRW',
                cidMobile1: '7L9HQ',
                cidMobile2: '78LYX',
                cidMobile3: '7HF79',
                cidMobile4: '7YU8F',
                cidMobile5: '7FQKH'
            },
            GB: {
                headline1stln: 'Inside access.',
                headline2ndln: '<span class="shownarrow">Inside access.<br></span>Outside perspective.<br><span class="subline">See the story more clearly.</span>',
                offerText: '<strong>Up to 60% off for<br>one year.</strong>',
                offerTextMobile: '<strong>Up to 60% off for one year.</strong>',
                lp: 'lp8U87U.html',
                cidDesktop1: '7FUK9',
                cidDesktop2: '79UFW',
                cidDesktop3: '79LFJ',
                cidDesktop4: '7X7U8',
                cidDesktop5: '77HRW',
                cidMobile1: '7L9HQ',
                cidMobile2: '78LYX',
                cidMobile3: '7HF79',
                cidMobile4: '7YU8F',
                cidMobile5: '7FQKH'
            },
            EU: {
                headline1stln: 'Inside access.',
                headline2ndln: '<span class="shownarrow">Inside access.<br></span>Outside perspective.<br><span class="subline">See the story more clearly.</span>',
                offerText: '<strong>Up to 60% off for<br>one year.</strong>',
                offerTextMobile: '<strong>Up to 60% off for one year.</strong>',
                lp: 'lp8U87U.html',
                cidDesktop1: '7FUK9',
                cidDesktop2: '79UFW',
                cidDesktop3: '79LFJ',
                cidDesktop4: '7X7U8',
                cidDesktop5: '77HRW',
                cidMobile1: '7L9HQ',
                cidMobile2: '78LYX',
                cidMobile3: '7HF79',
                cidMobile4: '7YU8F',
                cidMobile5: '7FQKH'
            },
            CA: {
                headline1stln: 'America&rsquo;s elections.',
                headline2ndln: '<span class="shownarrow">America&rsquo;s elections.<br></span>Canada&rsquo;s outcomes<br><span class="subline">Full coverage of the 2018<br>midterms.</span>',
                offerText: '<strong>60% off for one year.</strong>',
                offerTextMobile: '<strong>60% off for one year.</strong>',
                lp: 'lp8U87X.html',
                cidDesktop1: '7FUK9',
                cidDesktop2: '79UFW',
                cidDesktop3: '79LFJ',
                cidDesktop4: '7X7U8',
                cidDesktop5: '77HRW',
                cidMobile1: '7L9HQ',
                cidMobile2: '78LYX',
                cidMobile3: '7HF79',
                cidMobile4: '7YU8F',
                cidMobile5: '7FQKH'
            },
            AU: {
                offerText: '<strong>60% off for one year.</strong>',
                offerTextMobile: '<strong>60% off for one year.</strong>',
                lp: 'lp8U87A.html',
                cidDesktop1: '7FUK9',
                cidDesktop2: '79UFW',
                cidDesktop3: '79LFJ',
                cidDesktop4: '7X7U8',
                cidDesktop5: '77HRW',
                cidMobile1: '7L9HQ',
                cidMobile2: '78LYX',
                cidMobile3: '7HF79',
                cidMobile4: '7YU8F',
                cidMobile5: '7FQKH'
            }
        }
    }
};

// Sets the campaign ID per meter and per desktop or mobile
function meterCid(currency) {
    var currencyObject = MKDATA.dock_offer.currencyData[currency];
    if (cid === 'mobile') {
        if (meterCount === 1) {
            cidNew = currencyObject.cidMobile1;
        }
        if (meterCount === 2) {
            cidNew = currencyObject.cidMobile2;
        }
        if (meterCount === 3) {
            cidNew = currencyObject.cidMobile3;
        }
        if (meterCount === 4) {
            cidNew = currencyObject.cidMobile4;
        }
        if (meterCount === 5) {
            cidNew = currencyObject.cidMobile5;
        }
    } else {
        if (meterCount === 1) {
            cidNew = currencyObject.cidDesktop1;
        }
        if (meterCount === 2) {
            cidNew = currencyObject.cidDesktop2;
        }
        if (meterCount === 3) {
            cidNew = currencyObject.cidDesktop3;
        }
        if (meterCount === 4) {
            cidNew = currencyObject.cidDesktop4;
        }
        if (meterCount === 5) {
            cidNew = currencyObject.cidDesktop5;
        }
    }
    return cidNew;
}
var cmpID = meterCid(queryCountry);

var vi_dock_function = function () {
    var changeCurrency = function (currency) {
        if (currency !== '') {
            var currencyObject = MKDATA.dock_offer.currencyData[currency];
            var cta = window.NYToptly.vi_dock.subscribeURL;

            var ctaLP = cta.substring(cta.lastIndexOf('/') + 1);

            optlyDockUrl = cta.replace(ctaLP, currencyObject.lp + '?campaignId=' + cmpID);
            window.NYToptly.vi_dock.subscribeURL = optlyDockUrl;

            // change collapsed dock copy based on screen size~208123
            if ((location.hostname.indexOf('mobile.nytimes.com') > -1) || (window.screen.width < 768)) {
                window.NYToptly.vi_dock.offerCopy = window.exoOptly.urgency.USmob;
            } else {
                window.NYToptly.vi_dock.offerCopy = window.exoOptly.urgency.US;
            }

            //updates collapsed dock offer text per region
            window.NYToptly.vi_dock.offerCopy = 'THE SUBSCRIPTION SALE. <strong>Just $1 a week, plus Cooking and Crossword on us.</strong>';

            if (currency === 'US') {
                if (cid === 'mobile') {
                    window.NYToptly.vi_dock.offerCopy = window.exoOptly.urgency.ROWmob;
                } else {
                    window.NYToptly.vi_dock.offerCopy = window.exoOptly.urgency.ROW;
                }
            }
            if (currency === 'EU' || currency === 'GB') {
                if (cid === 'mobile') {
                    window.NYToptly.vi_dock.offerCopy = window.exoOptly.urgency.EUmob;
                } else {
                    window.NYToptly.vi_dock.offerCopy = window.exoOptly.urgency.EU;
                }
            }
            if (currency === 'CA' || currency === 'AU') {
                if (cid === 'mobile') {
                    window.NYToptly.vi_dock.offerCopy = window.exoOptly.urgency.CAmob;
                } else {
                    window.NYToptly.vi_dock.offerCopy = window.exoOptly.urgency.CA;
                }
            }
        }

        // console.log('---------------------------------- change currency: ' + currency);
    };
    changeCurrency(queryCountry);
};
window.NYToptly.vi_dock_function = vi_dock_function;

// Updates expanded dock offer text per region
var changeOfferText = function (currency) {
    var currencyObject = MKDATA.dock_offer.currencyData[currency];
    var app = document.getElementById('app');
    var headlineDesk1stln = app.querySelectorAll('.cardHeading1');
    var headlineDesk2ndln = app.querySelectorAll('.cardHeading2');
    // var headlineDesk2ndln = document.querySelector('.cardHeading2');
    var offersDesk = app.querySelectorAll('.headlineMain');
    var offersUrgency = app.querySelectorAll('.q2urgency'); // app.querySelectorAll('.q2urgency');
    // var headlinePosition = app.querySelectorAll('.cardHeading3');

    if (currency === 'EU' || currency === 'GB' || currency === 'CA') {
        // if ((location.hostname.indexOf('mobile.nytimes.com') > -1) || (window.screen.width < 768)) {
        // if (currency === 'CA' && (window.screen.width > 766 && window.screen.width < 1025)) {
        //     headlinePosition.forEach(function (el) {
        //         el.style.top = '-73px';
        //     });    
        // }        
        headlineDesk1stln.forEach(function (el) {
            el.innerHTML = currencyObject.headline1stln;
        });
        headlineDesk2ndln.forEach(function (el) {
            el.innerHTML = currencyObject.headline2ndln;
        });
    }
    offersDesk.forEach(function (el) {
        el.innerHTML = currencyObject.offerText;
    });
    offersUrgency.forEach(function (el) {
        el.innerHTML = window.exoOptly.urgency.expDockGate;
    });
};

// Writes updated LP and offer text to expanded dock
utils.waitForElement('.vi_dock .card').then(function () {
    var dockCTA = document.querySelector('.dock__content a');
    dockCTA.setAttribute('href', optlyDockUrl);
    changeOfferText(queryCountry);
});

    //  ---------------------   End Internationalize   ---------------------
}}, {"name": "Dock Multi-Link", "config": {"dock_content_html": "<div class=\"card dock__content optly-desk-mob\">\n    <a href=\"https://www.nytimes.com/subscription/multiproduct/lp8U87R.html\" target=\"_blank\">\n        <div class=\"greypart\">\n            <div class=\"logo\"></div>\n            <div class=\"cardHeading1\">Champion facts.</div>\n        </div>\n        <div class=\"cardContent\">\n            <div class=\"cardMessaging\">\n                <div class=\"cardHeading2\">\n                    <span class=\"shownarrow\">Champion facts.<br></span>\n                    Challenge spin.<br>\n                    <span class=\"subline\">News without fear or favor.</span>\n                </div>\n                <div class=\"cardHeading3\">\n                    <p class=\"cardMessage offer__heading\">\n                        <span>THE SUBSCRIPTION SALE</span>\n                    </p>\n                    <p class=\"cardMessage offer__text\">\n                        <span class=\"cardMessage\">\n                            <span class=\"headlineMain\"><strong>Just $1 a week, plus Cooking and <span class=\"shownarrow\"><br></span>Crossword on us.</strong>\n                            </span>\n                            <span class=\"q2urgency\"></span>\n                        </span>\n                        <div class=\"subscribeButton\">Subscribe Now</div>\n                    </p>\n                </div>\n            </div>\n        </div>\n    </a>\n</div>", "dock_header_meter_copy": "You have <strong>{{articleLeft}} free {{articleNoun}}</strong> remaining.", "dock_header_subscribe_link_3": "https://www.nytimes.com/subscription/inyt/lp8U87R.html", "dock_campaign_name": "nons_inyt_saleRTSROW_050818_dock", "creator": "sm", "dock_header_offer_copy": "THE SUBSCRIPTION SALE. <strong>Just $1 a week, plus Cooking and Crossword on us.</strong>", "dock_header_subscribe_link_2": "https://www.nytimes.com/subscription/inyt/lp8U87R.html", "dock_header_subscribe_link_1": "https://www.nytimes.com/subscription/inyt/lp8U87R.html", "dock_campaign_code_5": "7RFWK,7H8UU", "dock_subscribe_link_cta": "Subscribe Now", "dock_campaign_code_3": "7LF87,7QHWX", "dock_campaign_code_2": "7KJFQ,79WWU", "dock_campaign_code_1": "77JFL,7KFRW", "dock_header_subscribe_link_4": "https://www.nytimes.com/subscription/inyt/lp8U87R.html", "dock_header_subscribe_link_5": "https://www.nytimes.com/subscription/inyt/lp8U87R.html", "dock_campaign_code_4": "7LRHK,79RRH", "dock_content_css": ".font-smoothing {\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n.nowrap {\n  white-space: nowrap;\n}\n\n.optimizelyOK.vi_dock b,\n.optimizelyOK.vi_dock strong {\n  font-weight: 700;\n}\n\n.optimizelyOK.vi_dock .card {\n  position: relative;\n  height: 140px;\n  border-radius: 6px;\n  margin: auto;\n  max-width: 984px;\n  background-color: #059586;\n}\n\n.optimizelyOK.vi_dock .card .greypart {\n  background-color: #f2f2f2;\n  width: 436px;\n  height: 140px;\n  margin: 0;\n}\n\n.optimizelyOK.vi_dock .card .greypart .logo {\n  background: transparent url(https://mwcm.nyt.com/dam/mkt_assets/exo/img/nyt-logo-379x64.svg) no-repeat 0 44px;\n  background-size: 140px;\n  width: 140px;\n  height: 120px;\n  margin-right: 52px;\n  margin-left: 36px;\n  display: inline-block;\n}\n\n@media screen and (max-width: 1024px) {\n  .optimizelyOK.vi_dock .card .greypart .logo {\n    margin: 98px 0 0 30px;\n    background-position: 0 0;\n    height: 30px;\n  }\n}\n\n.optimizelyOK.vi_dock .card .greypart .cardHeading1 {\n  color: #059586;\n  font-size: 18px;\n  line-height: 19px;\n  font-family: nyt-karnak, \"nyt-karnak-display\", \"nyt-karnak-display-130124\", georgia, \"times new roman\", times, serif;\n  font-weight: 700;\n  display: inline-block;\n  position: relative;\n  top: -59px;\n}\n\n@media screen and (max-width: 1024px) {\n  .optimizelyOK.vi_dock .card .greypart .cardHeading1 {\n    left: 30px;\n    top: -94px;\n  }\n}\n\n@media screen and (max-width: 1024px) {\n  .optimizelyOK.vi_dock .card .greypart {\n    width: 216px;\n  }\n}\n\n@media screen and (max-width: 767px) {\n  .optimizelyOK.vi_dock .card .greypart {\n    display: none;\n  }\n}\n\n.optimizelyOK.vi_dock .card .cardContent {\n  width: 56%;\n  font-size: 16px;\n  line-height: 16px;\n  color: #fff;\n  display: inline;\n  position: relative;\n  float: right;\n  top: -132px;\n  height: 100%;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  padding: 14px 20px 15px 20px;\n  font-family: \"nyt-franklin\", \"Helvetica Neue\", Arial, sans-serif;\n  font-weight: 300;\n}\n\n@media screen and (max-width: 1024px) {\n  .optimizelyOK.vi_dock .card .cardContent {\n    padding: 0;\n    margin-left: 256px;\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: normal;\n        -ms-flex-flow: row;\n            flex-flow: row;\n    float: left;\n  }\n}\n\n@media screen and (max-width: 924px) {\n  .optimizelyOK.vi_dock .card .cardContent {\n    margin-left: 240px;\n  }\n}\n\n@media screen and (max-width: 767px) {\n  .optimizelyOK.vi_dock .card .cardContent {\n    width: 100%;\n    top: 0;\n    float: left;\n    padding: 14px 20px 15px 20px;\n    margin-left: 0;\n  }\n}\n\n.optimizelyOK.vi_dock .cardHeading2 {\n  font-size: 18px;\n  line-height: 19px;\n  font-family: nyt-karnak, \"nyt-karnak-display\", \"nyt-karnak-display-130124\", georgia, \"times new roman\", times, serif;\n  font-weight: 700;\n  margin-top: 26px;\n  margin-right: 12px;\n  width: 330px;\n}\n\n.optimizelyOK.vi_dock .cardHeading2 .shownarrow {\n  display: none;\n}\n\n@media screen and (max-width: 767px) {\n  .optimizelyOK.vi_dock .cardHeading2 .shownarrow {\n    display: block;\n  }\n}\n\n.optimizelyOK.vi_dock .cardHeading2 .subline {\n  font-family: \"nyt-franklin\", \"Helvetica Neue\", Arial, sans-serif;\n  font-weight: 300;\n}\n\n@media screen and (max-width: 767px) {\n  .optimizelyOK.vi_dock .cardHeading2 .subline {\n    display: none;\n  }\n}\n\n@media screen and (max-width: 1024px) {\n  .optimizelyOK.vi_dock .cardHeading2 {\n    margin-top: 30px;\n    width: 280px;\n    position: relative;\n    clear: right;\n    display: block;\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: normal;\n        -ms-flex-flow: row;\n            flex-flow: row;\n  }\n}\n\n@media screen and (max-width: 767px) {\n  .optimizelyOK.vi_dock .cardHeading2 {\n    width: 100%;\n    margin-top: 6px;\n    left: 0;\n  }\n}\n\n.optimizelyOK.vi_dock .cardHeading3 .offer__heading {\n  font-size: 10px;\n  color: #20403D;\n  font-weight: 700;\n  letter-spacing: 0.075em;\n  word-spacing: 0.045em;\n  margin-bottom: 2px;\n}\n\n@media screen and (max-width: 767px) {\n  .optimizelyOK.vi_dock .cardHeading3 .offer__heading {\n    display: none;\n  }\n}\n\n.optimizelyOK.vi_dock .cardHeading3 .headlineMain {\n  display: block;\n  clear: both;\n  width: 220px;\n}\n\n.optimizelyOK.vi_dock .cardHeading3 .headlineMain strong {\n  font-weight: 700;\n}\n\n.optimizelyOK.vi_dock .cardHeading3 .headlineMain .shownarrow {\n  display: none;\n}\n\n@media screen and (max-width: 767px) {\n  .optimizelyOK.vi_dock .cardHeading3 .headlineMain .shownarrow {\n    display: inline;\n  }\n}\n\n@media screen and (max-width: 767px) {\n  .optimizelyOK.vi_dock .cardHeading3 .headlineMain {\n    margin-top: 4px;\n    font-size: 14px;\n    display: inline;\n    clear: none;\n  }\n}\n\n.optimizelyOK.vi_dock .cardHeading3 .q2urgency {\n  display: block;\n  clear: both;\n}\n\n@media screen and (max-width: 767px) {\n  .optimizelyOK.vi_dock .cardHeading3 .q2urgency {\n    font-size: 14px;\n    display: inline;\n    clear: none;\n  }\n}\n\n@media screen and (max-width: 1024px) {\n  .optimizelyOK.vi_dock .cardHeading3 {\n    margin-top: 0;\n    width: 280px;\n    position: relative;\n    float: left;\n    top: -54px;\n    left: 320px;\n    clear: none;\n    display: block;\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: normal;\n        -ms-flex-flow: row;\n            flex-flow: row;\n  }\n}\n\n@media screen and (max-width: 998px) {\n  .optimizelyOK.vi_dock .cardHeading3 {\n    left: 294px;\n  }\n}\n\n@media screen and (max-width: 920px) {\n  .optimizelyOK.vi_dock .cardHeading3 {\n    left: 240px;\n  }\n}\n\n@media screen and (max-width: 767px) {\n  .optimizelyOK.vi_dock .cardHeading3 {\n    left: 0;\n    top: 0;\n  }\n}\n\n.optimizelyOK.vi_dock .subscribeButton {\n  font-size: 12px;\n  line-height: 13px;\n  display: inline-block;\n  padding: 9px 14px 7px;\n  color: #fff;\n  background-color: #F54331;\n  font-weight: 700;\n  text-transform: uppercase;\n  border-radius: 3px;\n  white-space: nowrap;\n  margin-top: 4px;\n}\n\n@media screen and (max-width: 767px) {\n  .optimizelyOK.vi_dock .subscribeButton {\n    padding: 9px 10px 6px;\n  }\n}\n\n@media screen and (min-width: 1024px) {\n  .optimizelyOK.vi_dock .cardContent {\n    font-size: 20px;\n    line-height: 20px;\n    padding-left: 45px;\n    padding-right: 50px;\n    -webkit-box-orient: horizontal;\n    -webkit-box-direction: normal;\n        -ms-flex-flow: row;\n            flex-flow: row;\n  }\n  .optimizelyOK.vi_dock .cardMessaging {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    margin-bottom: 10px;\n  }\n}\n"}, "id": "53A0B332-29F7-4E84-A139-BA97F9F3F69A", "dependencies": [], "type": "widget", "widget_id": "9858695532"}]}});